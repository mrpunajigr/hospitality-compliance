(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9062],{424:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});var s=a(5155),r=a(2115);let l={small:"w-16 h-16",medium:"w-24 h-24",large:"w-32 h-32"};function n(e){let{currentImageUrl:t,onUploadSuccess:a,onUploadError:n,uploadEndpoint:i,uploadData:o,acceptedTypes:c=["image/jpeg","image/png","image/webp"],maxSizeMB:d=5,shape:u="circle",size:m="medium",title:h="Upload Image",description:p="Click to upload or drag and drop"}=e,[x,f]=(0,r.useState)(!1),[b,g]=(0,r.useState)(!1),[j,w]=(0,r.useState)(null),v=(0,r.useRef)(null),y=async e=>{if(!c.includes(e.type))return void n("Invalid file type. Accepted types: ".concat(c.join(", ")));if(e.size>1024*d*1024)return void n("File too large. Maximum size is ".concat(d,"MB"));let t=new FileReader;t.onload=()=>w(t.result),t.readAsDataURL(e),f(!0);try{let t=new FormData;t.append("file",e),Object.entries(o).forEach(e=>{let[a,s]=e;t.append(a,s)});let s=await fetch(i,{method:"POST",body:t}),r=await s.json();if(!s.ok)throw Error(r.error||"Upload failed");a(r.avatar_url||r.logo_url),w(null)}catch(e){console.error("Upload error:",e),n(e instanceof Error?e.message:"Upload failed"),w(null)}finally{f(!1)}},N=(e,t)=>{e.preventDefault(),e.stopPropagation(),g(t)},I=j||t,E=l[m];return(0,s.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[(0,s.jsxs)("div",{className:"".concat(E," ").concat("circle"===u?"rounded-full":"rounded-lg"," bg-white/20 backdrop-blur-sm border-2 border-dashed border-white/30 overflow-hidden cursor-pointer transition-all duration-200 hover:border-white/50 ").concat(b?"border-blue-400 bg-blue-50/20":""," ").concat(x?"opacity-50":""),onDrop:e=>{e.preventDefault(),e.stopPropagation(),g(!1);let t=Array.from(e.dataTransfer.files);t.length>0&&y(t[0])},onDragOver:e=>N(e,!0),onDragEnter:e=>N(e,!0),onDragLeave:e=>N(e,!1),onClick:()=>{var e;null==(e=v.current)||e.click()},children:[I?(0,s.jsx)("img",{src:I,alt:"Preview",className:"w-full h-full object-cover"}):(0,s.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-white/60 text-center",children:[(0,s.jsx)("svg",{className:"w-8 h-8 mx-auto mb-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),(0,s.jsx)("p",{className:"text-xs",children:"Upload"})]})}),x&&(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50 rounded-inherit",children:(0,s.jsx)("div",{className:"animate-spin h-6 w-6 border-2 border-white border-t-transparent rounded-full"})})]}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-white mb-1",children:h}),(0,s.jsx)("p",{className:"text-xs text-white/60",children:p}),(0,s.jsxs)("p",{className:"text-xs text-white/50 mt-1",children:[c.map(e=>e.split("/")[1].toUpperCase()).join(", ")," • Max ",d,"MB"]})]}),(0,s.jsx)("input",{ref:v,type:"file",accept:c.join(","),onChange:e=>{let t=e.target.files;t&&t.length>0&&y(t[0])},className:"hidden"})]})}},1811:(e,t,a)=>{"use strict";a.d(t,{BP:()=>f,HK:()=>h,FX:()=>x,tB:()=>p,supabase:()=>j});var s=a(5647),r=a(9535),l=a(9509);let n="https://rggdywqnvpuwssluzfud.supabase.co",i="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJnZ2R5d3FudnB1d3NzbHV6ZnVkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQzOTIwMTAsImV4cCI6MjA2OTk2ODAxMH0.j1AiBUEfjqVxLu8ARtH5B_DBKI1dg2EKgp_VZtprAzg";if(!n||!i)throw Error("Missing Supabase environment variables. Please ensure NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY are set.");let o=(0,r.createBrowserClient)(n,i),c=l.env.NEXT_PUBLIC_SUPABASE_SERVICE_ROLE_KEY||l.env.SUPABASE_SERVICE_ROLE_KEY;c&&(0,s.UU)(n,c,{auth:{autoRefreshToken:!1,persistSession:!1}});let d="delivery-dockets",u=new Map,m=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3600;if(arguments.length>2&&arguments[2],!e||""===e.trim()||"null"===e||"undefined"===e)return"";try{let a=e.split("/").pop()||e;console.log("\uD83D\uDD0D Generating signed URL for:",a),console.log("\uD83D\uDD0D Using bucket:",d),console.log("\uD83D\uDD0D Original path:",e);let{data:s,error:r}=await o.storage.from(d).list("",{limit:100});console.log("\uD83D\uDD0D Files in bucket:",(null==s?void 0:s.map(e=>e.name))||[]),console.log("\uD83D\uDD0D Looking for file:",a);let l=o.storage.from(d).createSignedUrl(a,t),{data:n,error:i}=await new Promise((e,t)=>{let a=setTimeout(()=>{t(Error("Timeout after ".concat(1e4,"ms")))},1e4);l.then(e).catch(t).finally(()=>clearTimeout(a))});if(i)return console.error("❌ Signed URL generation failed:",i),"";if(null==n?void 0:n.signedUrl)return console.log("✅ Signed URL generated:",n.signedUrl),n.signedUrl;return console.log("❌ No signed URL returned from Supabase"),""}catch(e){return console.error("❌ Signed URL exception:",e),""}},h=async(e,t)=>await m(e,3600,t),p=async(e,t)=>{let{data:a,error:s}=await o.from("client_users").select("role").eq("user_id",e).eq("client_id",t).eq("status","active").single();return s?(console.error("Error fetching user role:",s),null):(null==a?void 0:a.role)||null},x=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50,a="delivery-records-".concat(e,"-").concat(t);if(u.has(a))return u.get(a);let s=(async()=>{try{let a=new AbortController,s=setTimeout(()=>a.abort(),3e4),r=await fetch("/api/delivery-records?clientId=".concat(e,"&limit=").concat(t),{signal:a.signal});if(clearTimeout(s),!r.ok)throw Error("HTTP ".concat(r.status,": Failed to fetch delivery records"));let l=await r.json();if(!l.success)throw Error(l.error||"Failed to fetch delivery records");return l.data||[]}catch(t){return t instanceof Error&&"AbortError"===t.name?console.error("⏰ Delivery records request timed out for clientId:",e):console.error("❌ Error fetching delivery records for clientId:",e,t),[]}finally{u.delete(a)}})();return u.set(a,s),s},f=async e=>{let t="compliance-alerts-".concat(e);if(u.has(t))return u.get(t);let a=(async()=>{try{let t=new AbortController,a=setTimeout(()=>t.abort(),3e4),s=await fetch("/api/compliance-alerts?clientId=".concat(e),{signal:t.signal});if(clearTimeout(a),!s.ok)return console.warn("⚠️ Compliance alerts API not configured for demo mode"),[];let r=await s.json();if(!r.success)return[];return r.data||[]}catch(e){return e instanceof Error&&"AbortError"===e.name?console.warn("⏰ Compliance alerts request timed out"):console.warn("⚠️ Compliance alerts not available in demo mode"),[]}finally{u.delete(t)}})();return u.set(t,a),a};var b=a(9509);let g=null;try{let e="https://rggdywqnvpuwssluzfud.supabase.co",t="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJnZ2R5d3FudnB1d3NzbHV6ZnVkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQzOTIwMTAsImV4cCI6MjA2OTk2ODAxMH0.j1AiBUEfjqVxLu8ARtH5B_DBKI1dg2EKgp_VZtprAzg",a=b.env.SUPABASE_SERVICE_ROLE_KEY;e&&t&&(g=(0,s.UU)(e,t,{auth:{persistSession:!0,autoRefreshToken:!0,storageKey:"hospitality-compliance-auth"}})),e&&a&&(0,s.UU)(e,a,{auth:{autoRefreshToken:!1,persistSession:!1}})}catch(e){console.warn("Supabase client initialization failed:",e instanceof Error?e.message:"Unknown error")}let j=g;console.log("\uD83D\uDE80 Database Core lib loaded - Modular Architecture v1.8.19")},4205:(e,t,a)=>{Promise.resolve().then(a.bind(a,7900))},7900:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>d});var s=a(5155),r=a(2115),l=a(1811),n=a(424),i=a(8337),o=a(9175);let c="550e8400-e29b-41d4-a716-446655440001";function d(){let[e,t]=(0,r.useState)(null),[a,d]=(0,r.useState)(null),[u,m]=(0,r.useState)(null),[h,p]=(0,r.useState)(!0);return((0,r.useEffect)(()=>{(async()=>{try{let{data:{user:e}}=await l.supabase.auth.getUser();t(e||{id:"a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a01",email:"demo@example.com"});let{data:a,error:s}=await l.supabase.from("clients").select("*").eq("id",c).single();!s&&a?(d(a),m(a.logo_url)):d({id:c,name:"Demo Restaurant Ltd",business_type:"restaurant",business_email:"info@demorestaurant.com",phone:"+64 9 123 4567",logo_url:null})}catch(e){console.error("Error fetching data:",e)}finally{p(!1)}})()},[]),h)?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsx)("div",{className:(0,i.ed)("primary"),children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin h-8 w-8 border-2 border-white border-t-transparent rounded-full mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-white font-medium",children:"Loading Settings..."})]})})}):(0,s.jsxs)("div",{className:"min-h-screen",children:[(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsx)("div",{className:"flex justify-between items-center py-6",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"".concat((0,i.$$)("pageTitle")," text-white"),children:"Settings"}),(0,s.jsx)("p",{className:"".concat((0,i.$$)("bodySmall")," text-white/70"),children:"Manage your company configuration and preferences"}),(0,s.jsx)("p",{className:"text-blue-300 text-xs mt-1",children:"Demo Mode"})]})})}),(0,s.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,s.jsxs)("div",{className:"bg-white/15 backdrop-blur-lg border border-white/20 rounded-3xl p-8 shadow-2xl mb-8",children:[(0,s.jsx)("h2",{className:"".concat((0,i.$$)("sectionTitle")," text-white mb-6"),children:"Company Branding"}),(0,s.jsxs)("div",{className:"flex items-start space-x-8",children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:(0,s.jsx)(n.A,{currentImageUrl:u,onUploadSuccess:e=>{m(e),alert("Company logo updated successfully!")},onUploadError:e=>{console.error("Logo upload error:",e),alert("Logo upload failed: ".concat(e))},uploadEndpoint:"/api/upload-client-logo",uploadData:{clientId:(null==a?void 0:a.id)||c,userId:(null==e?void 0:e.id)||""},acceptedTypes:["image/jpeg","image/png","image/webp","image/svg+xml"],maxSizeMB:10,shape:"square",size:"large",title:"Company Logo",description:"Upload your business logo"})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h3",{className:"".concat((0,i.$$)("cardTitle")," text-white mb-2"),children:"Brand Guidelines"}),(0,s.jsxs)("div",{className:"text-sm text-white/80 space-y-2",children:[(0,s.jsx)("p",{children:"• Logo should be clear and professional"}),(0,s.jsx)("p",{children:"• Supported formats: JPG, PNG, WebP, SVG"}),(0,s.jsx)("p",{children:"• Maximum file size: 10MB"}),(0,s.jsx)("p",{children:"• Recommended dimensions: 400x400px minimum"}),(0,s.jsx)("p",{children:"• Your logo will appear in navigation and reports"})]})]})]})]}),(0,s.jsxs)("div",{className:"bg-white/15 backdrop-blur-lg border border-white/20 rounded-3xl p-8 shadow-2xl mb-8",children:[(0,s.jsx)("h2",{className:"".concat((0,i.$$)("sectionTitle")," text-white mb-6"),children:"Company Information"}),(0,s.jsxs)("form",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block ".concat((0,i.$$)("label")," text-white mb-2"),children:"Company Name"}),(0,s.jsx)("input",{type:"text",defaultValue:(null==a?void 0:a.name)||"Demo Restaurant Ltd",className:(0,i._c)()})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block ".concat((0,i.$$)("label")," text-white mb-2"),children:"Business Type"}),(0,s.jsxs)("select",{defaultValue:(null==a?void 0:a.business_type)||"restaurant",className:"w-full px-4 py-3 bg-white/30 border border-white/30 rounded-xl text-gray-900 backdrop-blur-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,s.jsx)("option",{value:"restaurant",children:"Restaurant"}),(0,s.jsx)("option",{value:"cafe",children:"Caf\xe9"}),(0,s.jsx)("option",{value:"hotel",children:"Hotel"}),(0,s.jsx)("option",{value:"catering",children:"Catering"})]})]})]}),(0,s.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block ".concat((0,i.$$)("label")," text-white mb-2"),children:"Business Email"}),(0,s.jsx)("input",{type:"email",defaultValue:(null==a?void 0:a.business_email)||"info@demorestaurant.com",className:(0,i._c)()})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block ".concat((0,i.$$)("label")," text-white mb-2"),children:"Phone Number"}),(0,s.jsx)("input",{type:"tel",defaultValue:(null==a?void 0:a.phone)||"+64 9 123 4567",className:(0,i._c)()})]})]})]})]}),(0,s.jsxs)("div",{className:"bg-white/15 backdrop-blur-lg border border-white/20 rounded-3xl p-8 shadow-2xl mb-8",children:[(0,s.jsx)("h2",{className:"".concat((0,i.$$)("sectionTitle")," text-white mb-6"),children:"Compliance Settings"}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-white font-medium",children:"Temperature Monitoring"}),(0,s.jsx)("p",{className:"text-white/80 text-sm",children:"Enable automatic temperature alerts"})]}),(0,s.jsx)("button",{className:"relative inline-flex h-6 w-11 items-center rounded-full bg-blue-600 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:(0,s.jsx)("span",{className:"inline-block h-4 w-4 translate-x-6 rounded-full bg-white transition-transform"})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-white font-medium",children:"Daily Reports"}),(0,s.jsx)("p",{className:"text-white/80 text-sm",children:"Generate daily compliance reports"})]}),(0,s.jsx)("button",{className:"relative inline-flex h-6 w-11 items-center rounded-full bg-gray-400 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:(0,s.jsx)("span",{className:"inline-block h-4 w-4 translate-x-1 rounded-full bg-white transition-transform"})})]})]})]}),(0,s.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,s.jsx)("button",{className:"bg-white/20 hover:bg-white/30 text-gray-900 font-medium py-3 px-6 rounded-xl transition-all duration-200 border border-white/30 backdrop-blur-sm",children:"Cancel"}),(0,s.jsx)("button",{className:"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-xl transition-all duration-200 shadow-lg hover:shadow-xl",children:"Save Changes"})]}),(0,s.jsx)("div",{className:"text-center mt-8",children:(0,s.jsx)("span",{className:"".concat((0,i.$$)("version")," text-white/60"),children:(0,o.VM)("short")})})]})]})}},9175:(e,t,a)=>{"use strict";a.d(t,{VM:()=>o});let s={major:1,month:9,day:5,build:13,alpha:""},r="".concat(s.major,".").concat(s.month,".").concat(s.day,".").concat(String(s.build).padStart(3,"0")).concat(s.alpha),l="".concat(s.major,".").concat(s.month,".").concat(s.day).concat(s.alpha),n=new Date().toISOString().split("T")[0],i="production";parseInt(r.split(".")[0]),parseInt(r.split(".")[1]),r.split(".")[2];let o=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"short",t="v".concat(r);switch(e){case"short":default:return t;case"full":return"".concat(t," (").concat(n,")");case"detailed":return"".concat(t," (").concat(i,") - Built: ").concat(n);case"dev":return"".concat(t," | ").concat(i.toUpperCase());case"prod":return"v".concat(l)}}}},e=>{e.O(0,[9535,8337,8441,5964,7358],()=>e(e.s=4205)),_N_E=e.O()}]);