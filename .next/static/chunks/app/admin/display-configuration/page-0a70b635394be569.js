(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[316],{4594:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>m});var i=t(5155),a=t(2115),n=t(5695),l=t(1811),r=t(5552),d=t(8337);let c=[{key:"showSupplier",label:"Supplier Name",description:"Name of the delivery supplier",category:"mandatory"},{key:"showDeliveryDate",label:"Delivery Date",description:"Date when the delivery was made",category:"mandatory"},{key:"showSignedBy",label:"Signed By",description:"Person who signed for the delivery",category:"mandatory"},{key:"showTemperatureData",label:"Temperature Data",description:"Temperature readings and compliance status",category:"mandatory"},{key:"showProductClassification",label:"Product Classification",description:"Products categorized by temperature requirements",category:"mandatory"},{key:"showInvoiceNumber",label:"Invoice Number",description:"Invoice or docket reference number",category:"optional"},{key:"showItems",label:"Line Items",description:"Individual products and quantities",category:"optional"},{key:"showUnitSize",label:"Unit Sizes",description:"Package sizes (1kg, 500ml, etc.)",category:"optional"},{key:"showUnitPrice",label:"Unit Prices",description:"Individual item prices",category:"optional"},{key:"showSkuCode",label:"SKU/Product Codes",description:"Product codes and SKUs",category:"optional"},{key:"showTax",label:"Tax Information",description:"Tax amounts and rates",category:"optional"},{key:"showEstimatedValue",label:"Estimated Value",description:"Total estimated value of delivery",category:"optional"},{key:"showItemCount",label:"Item Count",description:"Number of individual items",category:"optional"}],o=[{id:"restaurant",name:"Restaurant Standard",description:"Basic compliance focus for restaurants"},{id:"hotel",name:"Hotel Catering",description:"Detailed setup with pricing and inventory"},{id:"cafe",name:"Caf\xe9 Basic",description:"Minimal setup for essential compliance only"},{id:"catering",name:"Catering Business",description:"Comprehensive financial tracking"}];function h(e){let{clientId:s,onConfigurationSaved:t}=e,[n,l]=(0,a.useState)(null),[r,h]=(0,a.useState)(!0),[m,u]=(0,a.useState)(!1),[x,p]=(0,a.useState)(null),[b,y]=(0,a.useState)(null),[f,g]=(0,a.useState)(!1);(0,a.useEffect)(()=>{j()},[s]);let j=async()=>{try{h(!0);let e=await fetch("/api/client-config/display?clientId=".concat(s)),t=await e.json();t.success?l(t.configuration):p("Failed to load configuration")}catch(e){p("Error loading configuration"),console.error("Configuration load error:",e)}finally{h(!1)}},w=(e,s)=>{n&&l(t=>t?{...t,displayPreferences:{...t.displayPreferences,[e]:s}}:t)},v=async e=>{try{u(!0),p(null);let i=await fetch("/api/client-config/display",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clientId:s,applyPreset:e})}),a=await i.json();a.success?(l(a.configuration),y(a.message),null==t||t(a.configuration),setTimeout(()=>y(null),3e3)):p(a.error||"Failed to apply preset")}catch(e){p("Error applying preset"),console.error("Preset application error:",e)}finally{u(!1)}},N=async()=>{if(n)try{u(!0),p(null);let e=await fetch("/api/client-config/display",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clientId:s,configuration:n})}),i=await e.json();i.success?(l(i.configuration),y("Configuration saved successfully"),null==t||t(i.configuration),setTimeout(()=>y(null),3e3)):p(i.error||"Failed to save configuration")}catch(e){p("Error saving configuration"),console.error("Configuration save error:",e)}finally{u(!1)}};return r?(0,i.jsx)("div",{className:(0,d.ed)("primary"),children:(0,i.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,i.jsx)("div",{className:"w-8 h-8 border-4 border-white/30 border-t-white rounded-full animate-spin"}),(0,i.jsx)("span",{className:"ml-3 text-white",children:"Loading configuration..."})]})}):n?(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsxs)("div",{className:(0,d.ed)("primary"),children:[(0,i.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{className:"".concat((0,d.$$)("sectionTitle")," text-white mb-2"),children:"Results Display Configuration"}),(0,i.jsx)("p",{className:"".concat((0,d.$$)("body")," text-white/80 text-sm"),children:"Configure which fields appear in delivery docket results for this client"})]}),(0,i.jsx)("button",{onClick:()=>g(!f),className:"px-4 py-2 bg-white/20 hover:bg-white/30 text-white rounded-xl transition-all duration-200",children:f?"Hide Preview":"Show Preview"})]}),x&&(0,i.jsxs)("div",{className:"mb-6 bg-red-600/20 border border-red-400/30 rounded-xl p-4",children:[(0,i.jsx)("p",{className:"text-red-300 text-sm",children:x}),(0,i.jsx)("button",{onClick:()=>p(null),className:"mt-2 text-red-400 hover:text-red-300 text-sm underline",children:"Dismiss"})]}),b&&(0,i.jsx)("div",{className:"mb-6 bg-green-600/20 border border-green-400/30 rounded-xl p-4",children:(0,i.jsx)("p",{className:"text-green-300 text-sm",children:b})}),(0,i.jsxs)("div",{className:"mb-8",children:[(0,i.jsx)("h3",{className:"text-white font-medium mb-4",children:"Quick Setup - Industry Presets"}),(0,i.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:o.map(e=>(0,i.jsxs)("div",{className:"bg-white/10 rounded-xl p-4 hover:bg-white/15 transition-all duration-200 cursor-pointer",onClick:()=>v(e.id),children:[(0,i.jsx)("h4",{className:"text-white font-medium mb-2",children:e.name}),(0,i.jsx)("p",{className:"text-white/70 text-sm mb-3",children:e.description}),(0,i.jsx)("div",{className:"flex items-center justify-between",children:(0,i.jsx)("span",{className:"text-xs px-2 py-1 rounded-full ".concat(n.industryPreset===e.id?"bg-blue-600 text-white":"bg-white/20 text-white/70"),children:n.industryPreset===e.id?"Active":"Apply"})})]},e.id))})]})]}),(0,i.jsxs)("div",{className:(0,d.ed)("secondary"),children:[(0,i.jsx)("h3",{className:"text-white font-medium mb-4",children:"Mandatory Information (Always Displayed)"}),(0,i.jsx)("div",{className:"space-y-3",children:c.filter(e=>"mandatory"===e.category).map(e=>(0,i.jsxs)("div",{className:"flex items-center justify-between p-4 bg-white/5 rounded-xl opacity-75",children:[(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsx)("h4",{className:"text-white font-medium",children:e.label}),(0,i.jsx)("p",{className:"text-white/70 text-sm",children:e.description})]}),(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("input",{type:"checkbox",checked:!0,disabled:!0,className:"w-5 h-5 rounded bg-gray-600 border-gray-500 text-blue-600 opacity-75"}),(0,i.jsx)("span",{className:"ml-2 text-white/50 text-sm",children:"Required"})]})]},e.key))})]}),(0,i.jsxs)("div",{className:(0,d.ed)("secondary"),children:[(0,i.jsx)("h3",{className:"text-white font-medium mb-4",children:"Optional Information (Choose What to Display)"}),(0,i.jsx)("div",{className:"space-y-3",children:c.filter(e=>"optional"===e.category).map(e=>(0,i.jsxs)("div",{className:"flex items-center justify-between p-4 bg-white/5 rounded-xl hover:bg-white/10 transition-all duration-200",children:[(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsx)("h4",{className:"text-white font-medium",children:e.label}),(0,i.jsx)("p",{className:"text-white/70 text-sm",children:e.description})]}),(0,i.jsx)("div",{className:"flex items-center",children:(0,i.jsx)("input",{type:"checkbox",checked:n.optionalFields[e.key],onChange:()=>{var s;return s=e.key,void(n&&l(e=>{if(!e)return e;let t={...e};return t.optionalFields={...e.optionalFields,[s]:!e.optionalFields[s]},t}))},className:"w-5 h-5 rounded bg-white/20 border-white/30 text-blue-600 focus:ring-blue-500 focus:ring-offset-0"})})]},e.key))})]}),(0,i.jsxs)("div",{className:(0,d.ed)("secondary"),children:[(0,i.jsx)("h3",{className:"text-white font-medium mb-4",children:"Display Preferences"}),(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-white/80 text-sm font-medium mb-3",children:"Card Layout"}),(0,i.jsx)("div",{className:"grid grid-cols-3 gap-3",children:[{value:"compact",label:"Compact",description:"Essential info only"},{value:"detailed",label:"Detailed",description:"All selected fields"},{value:"minimal",label:"Minimal",description:"Critical compliance only"}].map(e=>(0,i.jsxs)("div",{className:"p-4 rounded-xl border cursor-pointer transition-all duration-200 ".concat(n.displayPreferences.resultsCardLayout===e.value?"border-blue-400 bg-blue-600/20":"border-white/30 bg-white/10 hover:bg-white/15"),onClick:()=>w("resultsCardLayout",e.value),children:[(0,i.jsx)("h4",{className:"text-white font-medium mb-1",children:e.label}),(0,i.jsx)("p",{className:"text-white/70 text-xs",children:e.description})]},e.value))})]}),(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text-white/80 text-sm font-medium",children:"Group by Temperature Category"}),(0,i.jsx)("p",{className:"text-white/60 text-xs",children:"Organize items by Frozen/Chilled/Ambient"})]}),(0,i.jsx)("input",{type:"checkbox",checked:n.displayPreferences.groupByTemperatureCategory,onChange:e=>w("groupByTemperatureCategory",e.target.checked),className:"w-5 h-5 rounded bg-white/20 border-white/30 text-blue-600 focus:ring-blue-500"})]}),(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text-white/80 text-sm font-medium",children:"Show AI Confidence Scores"}),(0,i.jsx)("p",{className:"text-white/60 text-xs",children:"Display how confident AI is about extracted data"})]}),(0,i.jsx)("input",{type:"checkbox",checked:n.displayPreferences.showConfidenceScores,onChange:e=>w("showConfidenceScores",e.target.checked),className:"w-5 h-5 rounded bg-white/20 border-white/30 text-blue-600 focus:ring-blue-500"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-white/80 text-sm font-medium mb-2",children:"Currency Symbol"}),(0,i.jsx)("input",{type:"text",value:n.displayPreferences.currencySymbol,onChange:e=>w("currencySymbol",e.target.value),className:"w-full px-3 py-2 bg-white/20 border border-white/30 rounded-lg text-white placeholder-white/60 focus:outline-none focus:border-white/50",placeholder:"$",maxLength:3})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-white/80 text-sm font-medium mb-2",children:"Temperature Unit"}),(0,i.jsxs)("select",{value:n.displayPreferences.temperatureUnit,onChange:e=>w("temperatureUnit",e.target.value),className:"w-full px-3 py-2 bg-white/20 border border-white/30 rounded-lg text-white focus:outline-none focus:border-white/50",children:[(0,i.jsx)("option",{value:"C",children:"Celsius (\xb0C)"}),(0,i.jsx)("option",{value:"F",children:"Fahrenheit (\xb0F)"})]})]})]})]})]}),(0,i.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,i.jsx)("button",{onClick:j,className:"px-6 py-3 bg-gray-600 hover:bg-gray-700 disabled:bg-gray-800 text-white rounded-xl transition-all duration-200",disabled:m,children:"Reset"}),(0,i.jsxs)("button",{onClick:N,disabled:m,className:"px-8 py-3 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-800 text-white rounded-xl transition-all duration-200 flex items-center space-x-2",children:[m&&(0,i.jsx)("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),(0,i.jsx)("span",{children:m?"Saving...":"Save Configuration"})]})]})]}):(0,i.jsx)("div",{className:(0,d.ed)("primary"),children:(0,i.jsxs)("div",{className:"text-center py-12",children:[(0,i.jsx)("p",{className:"text-white/80 mb-4",children:"No configuration found"}),(0,i.jsx)("button",{onClick:j,className:"px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl transition-all duration-200",children:"Retry Loading"})]})})}function m(){var e;let[s,t]=(0,a.useState)(null),[c,o]=(0,a.useState)(null),[m,u]=(0,a.useState)(!0),[x,p]=(0,a.useState)(null),b=(0,n.useRouter)();(0,a.useEffect)(()=>{y()},[]);let y=async()=>{try{let{data:{user:e}}=await l.supabase.auth.getUser();if(!e)return void b.push("/signin");{t(e);let s=await (0,r.LE)(e.id);s&&o(s)}}catch(e){console.error("Auth check error:",e),b.push("/signin")}finally{u(!1)}};return m?(0,i.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-900 via-blue-800 to-indigo-900 flex items-center justify-center",children:(0,i.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,i.jsx)("div",{className:"w-8 h-8 border-4 border-white/30 border-t-white rounded-full animate-spin"}),(0,i.jsx)("span",{className:"text-white text-lg",children:"Loading..."})]})}):s&&c?(0,i.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-900 via-blue-800 to-indigo-900",children:(0,i.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,i.jsxs)("div",{className:"mb-8",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{className:"".concat((0,d.$$)("pageTitle")," text-white mb-2"),children:"Display Configuration"}),(0,i.jsxs)("p",{className:"".concat((0,d.$$)("body")," text-white/80"),children:["Configure how delivery docket results are displayed for ",c.name]})]}),(0,i.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,i.jsx)("button",{onClick:()=>b.push("/admin"),className:"px-4 py-2 bg-white/20 hover:bg-white/30 text-white rounded-xl transition-all duration-200",children:"← Back to Admin"}),(0,i.jsxs)("div",{className:"text-right",children:[(0,i.jsx)("div",{className:"text-white font-medium",children:(null==(e=s.user_metadata)?void 0:e.full_name)||s.email}),(0,i.jsx)("div",{className:"text-white/70 text-sm",children:c.name})]})]})]}),x&&(0,i.jsx)("div",{className:(0,d.ed)("secondary"),children:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{className:"text-white font-medium mb-1",children:"Current Configuration"}),(0,i.jsxs)("p",{className:"text-white/80 text-sm",children:[x.configName," • ",x.industryPreset," preset"]})]}),(0,i.jsxs)("div",{className:"flex items-center space-x-4 text-sm",children:[(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("div",{className:"text-white font-medium",children:Object.values(x.optionalFields).filter(Boolean).length}),(0,i.jsx)("div",{className:"text-white/70",children:"Optional Fields"})]}),(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("div",{className:"text-white font-medium",children:x.displayPreferences.resultsCardLayout}),(0,i.jsx)("div",{className:"text-white/70",children:"Layout"})]}),(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("div",{className:"text-white font-medium",children:x.displayPreferences.temperatureUnit}),(0,i.jsx)("div",{className:"text-white/70",children:"Temperature"})]})]})]})})]}),(0,i.jsx)(h,{clientId:c.id,onConfigurationSaved:e=>{p(e),console.log("Configuration saved:",e)}}),(0,i.jsxs)("div",{className:"".concat((0,d.ed)("secondary")," mt-8"),children:[(0,i.jsx)("h3",{className:"text-white font-medium mb-4",children:"Configuration Help"}),(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h4",{className:"text-white font-medium mb-2",children:"Mandatory Fields"}),(0,i.jsx)("p",{className:"text-white/70 text-sm",children:"These fields are always shown for compliance and safety requirements. They cannot be disabled."})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h4",{className:"text-white font-medium mb-2",children:"Optional Fields"}),(0,i.jsx)("p",{className:"text-white/70 text-sm",children:"Choose which additional information to display based on your business needs. More fields provide more detail but may clutter the interface."})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h4",{className:"text-white font-medium mb-2",children:"Layout Options"}),(0,i.jsxs)("p",{className:"text-white/70 text-sm",children:[(0,i.jsx)("strong",{children:"Compact:"})," Essential info only",(0,i.jsx)("br",{}),(0,i.jsx)("strong",{children:"Detailed:"})," All selected fields",(0,i.jsx)("br",{}),(0,i.jsx)("strong",{children:"Minimal:"})," Critical compliance only"]})]})]}),(0,i.jsxs)("div",{className:"mt-6 p-4 bg-blue-600/20 border border-blue-400/30 rounded-xl",children:[(0,i.jsx)("h4",{className:"text-blue-300 font-medium mb-2",children:"\uD83D\uDCA1 Pro Tip"}),(0,i.jsx)("p",{className:"text-blue-200 text-sm",children:"Start with an industry preset that matches your business type, then customize individual fields as needed. You can always change settings later."})]})]}),(0,i.jsxs)("div",{className:"".concat((0,d.ed)("secondary")," mt-8"),children:[(0,i.jsx)("h3",{className:"text-white font-medium mb-4",children:"What This Configuration Does"}),(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,i.jsx)("div",{className:"w-2 h-2 bg-green-400 rounded-full"}),(0,i.jsx)("span",{className:"text-white/80 text-sm",children:"Controls which fields appear in delivery docket results after AI processing"})]}),(0,i.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,i.jsx)("div",{className:"w-2 h-2 bg-green-400 rounded-full"}),(0,i.jsx)("span",{className:"text-white/80 text-sm",children:"Affects how data is displayed in the dashboard and exported reports"})]}),(0,i.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,i.jsx)("div",{className:"w-2 h-2 bg-green-400 rounded-full"}),(0,i.jsx)("span",{className:"text-white/80 text-sm",children:"Changes take effect immediately for new document uploads"})]}),(0,i.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,i.jsx)("div",{className:"w-2 h-2 bg-yellow-400 rounded-full"}),(0,i.jsx)("span",{className:"text-white/80 text-sm",children:"Existing documents will use the new display settings when viewed"})]})]})]})]})}):(0,i.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-900 via-blue-800 to-indigo-900 flex items-center justify-center",children:(0,i.jsx)("div",{className:(0,d.ed)("primary"),children:(0,i.jsxs)("div",{className:"text-center py-8",children:[(0,i.jsx)("h2",{className:"".concat((0,d.$$)("sectionTitle")," text-white mb-4"),children:"Access Required"}),(0,i.jsx)("p",{className:"".concat((0,d.$$)("body")," text-white/80 mb-6"),children:"You need to be signed in with administrator access to view this page."}),(0,i.jsx)("button",{onClick:()=>b.push("/signin"),className:"px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl transition-all duration-200",children:"Sign In"})]})})})}},5695:(e,s,t)=>{"use strict";var i=t(8999);t.o(i,"redirect")&&t.d(s,{redirect:function(){return i.redirect}}),t.o(i,"usePathname")&&t.d(s,{usePathname:function(){return i.usePathname}}),t.o(i,"useRouter")&&t.d(s,{useRouter:function(){return i.useRouter}})},9835:(e,s,t)=>{Promise.resolve().then(t.bind(t,4594))}},e=>{e.O(0,[9535,8337,5552,8441,5964,7358],()=>e(e.s=9835)),_N_E=e.O()}]);