(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6789],{5010:(e,t,n)=>{Promise.resolve().then(n.bind(n,5206))},5206:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});var o=n(5155),s=n(5900);function r(e){let{children:t}=e;return(0,o.jsx)(s.jY,{children:t})}},5900:(e,t,n)=>{"use strict";n.d(t,{jY:()=>a,$N:()=>u,a3:()=>S});var o=n(5155),s=n(2115);n(9509);let r={SESSION_DURATION:288e5,SESSION_KEY:"hospitality_dev_session",COOKIE_NAME:"dev_session_token"};class i{static setSession(e){let t=btoa(JSON.stringify({username:e.username,role:e.role,loginTime:e.loginTime,expiresAt:e.expiresAt}));localStorage.setItem(r.SESSION_KEY,t),document.cookie="".concat(r.COOKIE_NAME,"=").concat(t,"; path=/dev; max-age=").concat(r.SESSION_DURATION/1e3)}static getSession(){try{let e=localStorage.getItem(r.SESSION_KEY);if(!e)return console.log("\uD83D\uDD27 DEV SESSION: No token found in localStorage"),null;let t=function(e){try{let t=JSON.parse(atob(e));if(Date.now()>t.expiresAt)return null;return{username:t.username,role:t.role,loginTime:t.loginTime,expiresAt:t.expiresAt}}catch{return null}}(e);return t?console.log("\uD83D\uDD27 DEV SESSION: Valid session found for",t.username):(console.log("\uD83D\uDD27 DEV SESSION: Invalid or expired token, clearing storage"),localStorage.removeItem(r.SESSION_KEY)),t}catch(e){return console.error("\uD83D\uDEAB DEV SESSION: Error retrieving session",e),null}}static clearSession(){localStorage.removeItem(r.SESSION_KEY),document.cookie="".concat(r.COOKIE_NAME,"=; path=/dev; expires=Thu, 01 Jan 1970 00:00:01 GMT")}static isAuthenticated(){return null!==this.getSession()}static hasRole(e){let t=this.getSession();if(!t)return!1;let n={DEV:1,SENIOR_DEV:2,ARCHITECT:3};return n[t.role]>=n[e]}}function l(e,t,n){let o=new Date().toISOString();console.log("\uD83D\uDD27 DEV ACCESS [".concat(o,"] ").concat(e.username," (").concat(e.role,") - ").concat(t," on ").concat(n))}let c=(0,s.createContext)(void 0);function a(e){let{children:t}=e,[n,r]=(0,s.useState)(null),[a,u]=(0,s.useState)(!0);(0,s.useEffect)(()=>{console.log("\uD83D\uDD27 DEV AUTH: Initializing context, checking for existing session...");let e=setTimeout(()=>{console.log("\uD83D\uDD27 DEV AUTH: Session check timeout - forcing no session state"),r(null),u(!1)},2e3);try{let t=i.getSession();console.log("\uD83D\uDD27 DEV AUTH: Session check result:",t?"".concat(t.username," (").concat(t.role,")"):"No session"),clearTimeout(e),r(t),u(!1),t&&l(t,"SESSION_RESTORED","dev-auth-context")}catch(t){console.error("\uD83D\uDEAB DEV AUTH: Error during session check:",t),clearTimeout(e),r(null),u(!1)}return()=>clearTimeout(e)},[]);let S=async(e,t)=>{try{let n=await fetch("/api/dev-auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:t})});if(n.ok){let e=await n.json(),t={username:e.username,role:e.role,loginTime:e.loginTime,expiresAt:e.expiresAt};return i.setSession(t),r(t),l(t,"LOGIN_SUCCESS","dev-portal"),!0}return!1}catch(e){return console.error("DEV login error:",e),!1}};return(0,o.jsx)(c.Provider,{value:{devUser:n,isAuthenticated:!!n,isLoading:a,login:S,logout:()=>{n&&l(n,"LOGOUT","dev-portal"),i.clearSession(),r(null)},hasRole:e=>i.hasRole(e),logAccess:(e,t)=>{n&&l(n,e,t)}},children:t})}function u(){let e=(0,s.useContext)(c);if(void 0===e)throw Error("useDevAuth must be used within a DevAuthProvider");return e}function S(e){let{requiredRole:t="DEV",fallback:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(s){let{isAuthenticated:r,hasRole:i,isLoading:l}=u();return l?(0,o.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-900",children:(0,o.jsxs)("div",{className:"text-center",children:[(0,o.jsx)("div",{className:"animate-spin h-8 w-8 border-2 border-orange-500 border-t-transparent rounded-full mx-auto mb-4"}),(0,o.jsx)("p",{className:"text-white",children:"Verifying DEV access..."})]})}):r&&i(t)?(0,o.jsx)(e,{...s}):n||(0,o.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-900",children:(0,o.jsxs)("div",{className:"text-center max-w-md mx-auto p-8",children:[(0,o.jsx)("div",{className:"w-20 h-20 mx-auto mb-6 bg-red-600 rounded-full flex items-center justify-center",children:(0,o.jsx)("span",{className:"text-3xl",children:"\uD83D\uDD12"})}),(0,o.jsx)("h1",{className:"text-3xl font-bold text-white mb-4",children:"Access Denied"}),(0,o.jsxs)("p",{className:"text-lg text-gray-300 mb-6",children:["You need ",t," level access to view this content."]}),(0,o.jsx)("a",{href:"/dev/login",className:"inline-block bg-orange-600 hover:bg-orange-700 text-white font-semibold py-3 px-6 rounded-lg transition-colors",children:"DEV Login"})]})})}}}},e=>{e.O(0,[8441,5964,7358],()=>e(e.s=5010)),_N_E=e.O()}]);