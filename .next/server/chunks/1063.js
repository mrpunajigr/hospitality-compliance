"use strict";exports.id=1063,exports.ids=[1063],exports.modules={55653:(a,b,c)=>{c.d(b,{A:()=>i});var d=c(60687),e=c(43210),f=c(31);function g({imagePath:a,imageUrl:b,onClose:c}){let[f,g]=(0,e.useState)(""),[h,i]=(0,e.useState)(!0);return a||b?(0,d.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",onClick:c,children:(0,d.jsxs)("div",{className:"relative max-w-4xl max-h-full",children:[(0,d.jsx)("button",{onClick:c,className:"absolute -top-10 right-0 text-white hover:text-gray-300 text-2xl font-bold","aria-label":"Close preview",children:"✕"}),(0,d.jsx)("div",{className:"bg-white rounded-lg p-2 shadow-2xl",onClick:a=>a.stopPropagation(),children:h?(0,d.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,d.jsx)("div",{className:"text-gray-600",children:"Loading preview..."})}):f?(0,d.jsx)("img",{src:f,alt:"Delivery docket preview",className:"max-w-full max-h-[80vh] object-contain rounded",loading:"lazy",onError:b=>{console.error("Failed to load image:",a)}}):(0,d.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,d.jsx)("div",{className:"text-gray-600",children:"Failed to load preview"})})}),(0,d.jsx)("div",{className:"text-center mt-2",children:(0,d.jsx)("span",{className:"text-white text-sm opacity-75",children:"Click outside to close • Press Escape"})})]})}):null}c(66143);var h=c(17335);function i({data:a,className:b="",userId:c,config:i=h.P}){let[j,k]=(0,e.useState)(""),[l,m]=(0,e.useState)(!0),[n,o]=(0,e.useState)(""),[p,q]=(0,e.useState)(!1);return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{className:`${(0,f.ed)("primary")} ${b}`,children:(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,d.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,d.jsx)("h3",{className:`${(0,f.$$)("sectionTitle")} text-white font-medium`,children:a.supplier_name||"SERVICE FOODS - AUCKLAND FOODSERVICE"}),a.confidence_score&&a.confidence_score>0&&(0,d.jsxs)("span",{className:"text-xs text-white/60 bg-white/10 px-2 py-1 rounded-full",children:[Math.round(100*a.confidence_score),"% confidence"]})]}),(0,d.jsxs)("div",{className:`${(0,f.$$)("body")} text-white/80`,children:[(0,d.jsx)("span",{className:"text-white/60",children:"Delivery:"})," ",(a=>{try{return new Date(a).toLocaleDateString("en-NZ",{day:"numeric",month:"short",year:"numeric"})}catch{return a}})(a.delivery_date)]}),void 0!==a.item_count&&a.item_count>0&&(0,d.jsxs)("div",{className:`${(0,f.$$)("body")} text-white/80 text-sm`,children:[(0,d.jsx)("span",{className:"text-white/60",children:"Items:"})," ",a.item_count," products"]}),(0,d.jsx)("div",{className:"space-y-2 text-sm",children:a.temperature_reading&&(0,d.jsxs)("div",{className:"text-white/70",children:[(0,d.jsx)("span",{className:"text-white/50",children:"Temperature:"})," ",a.temperature_reading]})}),(i.itemCode||i.itemDescription||i.quantity||i.unitPrice||i.totalAmount)&&(0,d.jsxs)("div",{className:"border-t border-white/10 pt-2 mt-2 space-y-1",children:[i.itemCode&&a.item_code&&(0,d.jsxs)("div",{className:`${(0,f.$$)("bodySmall")} text-white/70`,children:[(0,d.jsx)("span",{className:"text-white/50",children:"Code:"})," ",a.item_code]}),i.itemDescription&&a.item_description&&(0,d.jsxs)("div",{className:`${(0,f.$$)("bodySmall")} text-white/70`,children:[(0,d.jsx)("span",{className:"text-white/50",children:"Item:"})," ",a.item_description]}),(i.quantity||i.unitPrice||i.totalAmount)&&(0,d.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,d.jsxs)("div",{className:"flex space-x-4",children:[i.quantity&&a.quantity&&(0,d.jsxs)("span",{className:"text-white/70",children:[(0,d.jsx)("span",{className:"text-white/50",children:"Qty:"})," ",a.quantity]}),i.unitPrice&&a.unit_price&&(0,d.jsxs)("span",{className:"text-white/70",children:[(0,d.jsx)("span",{className:"text-white/50",children:"Price:"})," $",a.unit_price.toFixed(2)]})]}),i.totalAmount&&a.total_amount&&(0,d.jsxs)("span",{className:"text-white font-medium",children:["Total: $",a.total_amount.toFixed(2)]})]})]}),(0,d.jsxs)("div",{className:`${(0,f.$$)("body")} text-white/70 text-sm`,children:[(0,d.jsx)("span",{className:"text-white/50",children:"Uploaded:"})," ",(a=>{try{return new Date(a).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return a}})(a.created_at),(a.user_name||a.uploaded_by)&&(0,d.jsxs)("span",{children:[" by ",a.user_name||a.uploaded_by]})]})]}),a.image_path&&(0,d.jsx)("div",{className:"thumbnail-container cursor-pointer flex-shrink-0 ml-6",onClick:()=>n?q(!0):null,title:n?"Click to preview full image":"Loading image...",style:{transition:"all 0.3s ease",transformOrigin:"center"},onMouseEnter:a=>{!l&&j&&(a.currentTarget.style.transform="scale(1.3)",a.currentTarget.style.zIndex="10")},onMouseLeave:a=>{a.currentTarget.style.transform="scale(1)",a.currentTarget.style.zIndex="1"},children:l?(0,d.jsx)("div",{className:"w-20 h-20 bg-white/10 rounded-xl border-2 border-white/20 flex items-center justify-center animate-pulse",children:(0,d.jsx)("div",{className:"text-white/40 text-xs",children:"Loading..."})}):j?(0,d.jsx)("img",{src:j,alt:"Delivery docket thumbnail",className:"w-20 h-20 object-cover rounded-xl border-2 border-white/20 hover:border-white/40 transition-colors shadow-lg",loading:"lazy",onLoad:()=>{console.log("✅ Signed URL thumbnail loaded:",j)},onError:b=>{console.error("❌ Signed URL thumbnail failed to load:",j),console.error("❌ Image path in data:",a.image_path),console.error("❌ Image error event:",b),fetch(j,{method:"HEAD"}).then(a=>{console.log("\uD83D\uDD0D Direct fetch response status:",a.status),console.log("\uD83D\uDD0D Direct fetch response headers:",Object.fromEntries(a.headers.entries()))}).catch(a=>{console.error("❌ Direct fetch failed:",a)});let c=b.currentTarget;c.style.display="none";let d=document.createElement("div");d.className="w-20 h-20 bg-white/10 rounded-xl border-2 border-white/20 flex items-center justify-center",d.innerHTML='<div class="text-white/60 text-2xl">\uD83D\uDCC4</div>',c.parentNode?.appendChild(d)}}):(0,d.jsx)("div",{className:"w-20 h-20 bg-white/10 rounded-xl border-2 border-white/20 flex items-center justify-center",children:(0,d.jsx)("div",{className:"text-white/60 text-2xl",children:"\uD83D\uDCC4"})})})]})}),p&&n&&(0,d.jsx)(g,{imagePath:null,imageUrl:n,onClose:()=>q(!1)})]})}},88374:(a,b,c)=>{c.d(b,{A:()=>g});var d=c(60687),e=c(43210);c(66143);var f=c(31);function g({clientId:a,userId:b}){let[c,g]=(0,e.useState)({todaysDeliveries:0,complianceRate:0,activeAlerts:0,pendingAcknowledgments:0,weeklyTrend:0,monthlyTrend:0,avgTemperature:0,topSuppliers:[],riskSuppliers:[],peakViolationHours:[],deliveryPatterns:[],riskScore:0,recommendations:[]}),[h,i]=(0,e.useState)(!0),[j,k]=(0,e.useState)("week");return h?(0,d.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,d.jsx)("div",{className:(0,f.ed)("primary"),children:(0,d.jsxs)("div",{className:"text-center p-8",children:[(0,d.jsx)("div",{className:"animate-spin h-8 w-8 border-2 border-white border-t-transparent rounded-full mx-auto mb-4"}),(0,d.jsx)("p",{className:"text-white font-medium",children:"Loading intelligent dashboard..."})]})})}):(0,d.jsxs)("div",{className:"space-y-6",children:[(0,d.jsxs)("div",{className:"flex justify-between items-center",children:[(0,d.jsx)("h2",{className:`${(0,f.$$)("sectionTitle")} text-white`,children:"Compliance Intelligence Dashboard"}),(0,d.jsx)("div",{className:"flex bg-black/70 backdrop-blur-sm rounded-full p-1 border border-white/40",children:["today","week","month"].map(a=>(0,d.jsx)("button",{onClick:()=>k(a),className:`px-4 py-2 rounded-full text-sm font-medium transition-all duration-200 capitalize ${j===a?"bg-white text-black":"text-white/80 hover:text-white hover:bg-white/25"}`,children:a},a))})]}),(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,d.jsxs)("div",{className:(0,f.ed)("primary"),children:[(0,d.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,d.jsx)("div",{className:"text-3xl",children:"\uD83D\uDCCA"}),(0,d.jsxs)("div",{className:`flex items-center space-x-1 text-sm ${c.weeklyTrend>=0?"text-green-300":"text-red-300"}`,children:[(0,d.jsx)("span",{children:c.weeklyTrend>=0?"↑":"↓"}),(0,d.jsxs)("span",{children:[Math.abs(c.weeklyTrend),"%"]})]})]}),(0,d.jsxs)("div",{className:"text-3xl font-bold text-white mb-1",children:[c.complianceRate,"%"]}),(0,d.jsx)("div",{className:`${(0,f.$$)("body")} text-white/80 text-sm`,children:"Compliance Rate"}),(0,d.jsx)("div",{className:"mt-2 text-xs text-white/60",children:c.weeklyTrend>=0?"Improving":"Needs attention"})]}),(0,d.jsxs)("div",{className:(0,f.ed)("primary"),children:[(0,d.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,d.jsx)("div",{className:"text-3xl",children:"⚡"}),(0,d.jsx)("div",{className:`px-2 py-1 rounded-full text-xs font-medium ${c.riskScore<=20?"bg-green-600/20 text-green-300":c.riskScore<=50?"bg-yellow-600/20 text-yellow-300":"bg-red-600/20 text-red-300"}`,children:c.riskScore<=20?"Low Risk":c.riskScore<=50?"Medium Risk":"High Risk"})]}),(0,d.jsx)("div",{className:"text-3xl font-bold text-white mb-1",children:100-c.riskScore}),(0,d.jsx)("div",{className:`${(0,f.$$)("body")} text-white/80 text-sm`,children:"Safety Score"}),(0,d.jsx)("div",{className:"mt-2 w-full bg-white/20 rounded-full h-1.5",children:(0,d.jsx)("div",{className:`h-1.5 rounded-full transition-all duration-500 ${c.riskScore<=20?"bg-green-500":c.riskScore<=50?"bg-yellow-500":"bg-red-500"}`,style:{width:`${100-c.riskScore}%`}})})]}),(0,d.jsxs)("div",{className:(0,f.ed)("primary"),children:[(0,d.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,d.jsx)("div",{className:"text-3xl",children:"\uD83C\uDF21️"}),(0,d.jsx)("div",{className:`text-sm ${c.avgTemperature<=4?"text-green-300":"text-yellow-300"}`,children:"Target: ≤4\xb0C"})]}),(0,d.jsxs)("div",{className:"text-3xl font-bold text-white mb-1",children:[c.avgTemperature,"\xb0C"]}),(0,d.jsx)("div",{className:`${(0,f.$$)("body")} text-white/80 text-sm`,children:"Avg Temperature"}),(0,d.jsx)("div",{className:"mt-2 text-xs text-white/60",children:c.avgTemperature<=4?"Within safe range":"Monitor closely"})]}),(0,d.jsxs)("div",{className:(0,f.ed)("primary"),children:[(0,d.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,d.jsx)("div",{className:"text-3xl",children:"\uD83D\uDEA8"}),c.pendingAcknowledgments>0&&(0,d.jsxs)("div",{className:"bg-red-600 text-white text-xs px-2 py-1 rounded-full",children:[c.pendingAcknowledgments," pending"]})]}),(0,d.jsx)("div",{className:"text-3xl font-bold text-white mb-1",children:c.activeAlerts}),(0,d.jsx)("div",{className:`${(0,f.$$)("body")} text-white/80 text-sm`,children:"Active Alerts"}),(0,d.jsx)("div",{className:"mt-2 text-xs text-white/60",children:0===c.activeAlerts?"All clear":"Requires attention"})]})]}),(0,d.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,d.jsx)("div",{className:(0,f.ed)("secondary"),children:(0,d.jsxs)("div",{className:"p-6",children:[(0,d.jsx)("h3",{className:`${(0,f.$$)("sectionTitle")} text-white mb-4`,children:"Supplier Performance"}),c.topSuppliers.length>0?(0,d.jsx)("div",{className:"space-y-4",children:c.topSuppliers.map((a,b)=>(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,d.jsxs)("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold ${0===b?"bg-yellow-600 text-white":1===b?"bg-gray-400 text-white":"bg-orange-600 text-white"}`,children:["#",b+1]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{className:`${(0,f.$$)("body")} text-white font-medium`,children:a.name}),(0,d.jsxs)("div",{className:"text-white/60 text-sm",children:[a.deliveryCount," deliveries"]})]})]}),(0,d.jsxs)("div",{className:"text-right",children:[(0,d.jsxs)("div",{className:`font-medium ${a.complianceRate>=95?"text-green-300":a.complianceRate>=85?"text-yellow-300":"text-red-300"}`,children:[a.complianceRate,"%"]}),(0,d.jsxs)("div",{className:"text-white/60 text-xs",children:[a.avgTemperature,"\xb0C avg"]})]})]},a.name))}):(0,d.jsx)("p",{className:"text-white/60 text-center py-4",children:"No supplier data available yet"})]})}),(0,d.jsx)("div",{className:(0,f.ed)("form"),children:(0,d.jsxs)("div",{className:"p-6",children:[(0,d.jsx)("h3",{className:`${(0,f.$$)("sectionTitle")} text-gray-900 mb-4`,children:"AI Recommendations"}),c.recommendations.length>0?(0,d.jsx)("div",{className:"space-y-3",children:c.recommendations.slice(0,3).map((a,b)=>(0,d.jsx)("div",{className:`p-3 rounded-xl border-l-4 ${"critical"===a.type?"bg-red-50 border-red-500":"important"===a.type?"bg-yellow-50 border-yellow-500":"bg-blue-50 border-blue-500"}`,children:(0,d.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,d.jsx)("div",{className:"text-lg",children:"critical"===a.type?"\uD83D\uDEA8":"important"===a.type?"⚠️":"\uD83D\uDCA1"}),(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{className:"font-medium text-gray-900 text-sm",children:a.title}),(0,d.jsx)("div",{className:"text-gray-700 text-xs mt-1",children:a.description}),(0,d.jsxs)("div",{className:"text-gray-600 text-xs mt-2 italic",children:["\uD83D\uDCA1 ",a.action]})]})]})},b))}):(0,d.jsxs)("div",{className:"text-center py-4",children:[(0,d.jsx)("div",{className:"text-4xl mb-2",children:"✨"}),(0,d.jsx)("p",{className:"text-gray-600",children:"All systems running smoothly!"})]})]})})]}),c.riskSuppliers.length>0&&(0,d.jsx)("div",{className:`${(0,f.ed)("primary")} border-l-4 border-red-500`,children:(0,d.jsx)("div",{className:"p-6",children:(0,d.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,d.jsx)("div",{className:"text-2xl",children:"⚠️"}),(0,d.jsxs)("div",{children:[(0,d.jsx)("h4",{className:`${(0,f.$$)("sectionTitle")} text-white mb-2`,children:"High-Risk Suppliers Detected"}),(0,d.jsx)("p",{className:"text-white/80 mb-4",children:"The following suppliers show concerning compliance patterns and need immediate attention:"}),(0,d.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:c.riskSuppliers.map(a=>(0,d.jsxs)("div",{className:"bg-red-600/20 rounded-xl p-3",children:[(0,d.jsx)("div",{className:"font-medium text-white mb-1",children:a.name}),(0,d.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,d.jsxs)("div",{className:"text-red-300",children:[a.complianceRate,"% compliance"]}),(0,d.jsxs)("div",{className:"text-white/60",children:[a.violationCount," violations"]}),(0,d.jsxs)("div",{className:"text-white/60",children:[a.avgTemperature,"\xb0C average"]})]})]},a.name))})]})]})})})]})}}};